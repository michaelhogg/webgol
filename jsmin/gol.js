function GOLAnimator(a,b){this.gol=a,this.targetFPS=15,this.$actualFPSDisplayElement=$("#"+b),this.actualFPS=0,this.latestStepTimestamp=0,this.timerID=null,this.MS_PER_SECOND=1e3}function GOL(a,b){if(!window.WebGLRenderingContext)throw new Error("Browser does not support WebGLRenderingContext");if(this.CELL_SIZE=b,this.igloo=new Igloo(a),!(this.igloo.gl instanceof WebGLRenderingContext))throw new Error("Browser does support WebGLRenderingContext, but failed to initialise WebGL");this.gl=this.igloo.gl,this.gpu=new GOLGPU(this),this.VIEW_WIDTH=a.width,this.VIEW_HEIGHT=a.height,this.STATE_WIDTH=Math.floor(a.width/b),this.STATE_HEIGHT=Math.floor(a.height/b),this.TOTAL_CELLS=this.STATE_WIDTH*this.STATE_HEIGHT,this.enableWrapping=!0,this.enableMutation=!0,this.cornerColours={topLeft:new Float32Array([1,1,.1,1]),topRight:new Float32Array([1,.1,.1,1]),bottomLeft:new Float32Array([.1,1,.1,1]),bottomRight:new Float32Array([.1,.1,1,1])},this.TEXTURE_PIXELTYPE=this.gl.UNSIGNED_BYTE,this.TEXTURE_PIXELFORMAT=this.gl.RGBA,this.CHANNELS_PER_PIXEL=4,this.PIXEL_CHANNEL_MAX_VALUE=255,this.BITS_PER_PIXEL_CHANNEL=8,this.COLOUR_DEAD=new Uint8Array([0,0,0,this.PIXEL_CHANNEL_MAX_VALUE]),this.COLOUR_ALIVE=new Uint8Array([this.PIXEL_CHANNEL_MAX_VALUE,0,0,this.PIXEL_CHANNEL_MAX_VALUE]),this.MODE_RANDOM=1,this.MODE_PATTERNS=2,this.MODE_CUSTOM=3,this.currentMode=this.MODE_RANDOM,this.MUTATION_RATE=Math.ceil(1e-5*this.TOTAL_CELLS)}function GOLGPU(a){this.gol=a,this.igloo=a.igloo,this.gl=a.gl,this.blurBrighteningFactor=1.5,this.MAX_TEXTURE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}function GOLGPUProgram(a,b,c){this.gpu=a,this.gol=a.gol,this.program=new Igloo.Program(a.gl,b,c)}function GOLGPUProgramAddAndDisplay(a,b,c){GOLGPUProgram.call(this,a,b,c)}function GOLGPUProgramBlur(a,b,c){GOLGPUProgram.call(this,a,b,c)}function GOLGPUProgramNextState(a,b,c){GOLGPUProgram.call(this,a,b,c)}function GOLGPUProgramRender(a,b,c){GOLGPUProgram.call(this,a,b,c)}function GOLGrid(){this.cellData=[],this.width=0,this.height=0}function GOLUIButtonRandomModeRandomise(a){this.gol=a}function GOLUIMenuApplication(a,b){this.gol=a,this.panelKeyboardShortcuts=b,this.isOpen=!1}function GOLUIMenuCellSize(a){this.gol=a}function GOLUIPanelControl(){this.isOpen=!1}function GOLUIPanelKeyboardShortcuts(){this.isOpen=!1}function GOLUIShortcutKeys(a,b,c,d){this.golAnimator=a,this.toolbar=b,this.panelKeyboardShortcuts=c,this.panelControl=d}function GOLUISliderGlow(a){this.gpu=a}function GOLUISliderTargetFramerate(a){this.golAnimator=a}function GOLUISwitcheryMutation(a){this.gol=a,this.switchery=null}function GOLUISwitcheryWrapping(a){this.gol=a,this.switchery=null}function GOLUIToolbar(a,b){this.golAnimator=a,this.panelControl=b,this.isDisplayed=!1,this.hasControlPanelEverBeenOpened=!1,this.fadeoutTimeoutID=null}function GOLUI(a,b){this.gol=a,this.golAnimator=b,this.toolbar=null,this.panelControl=null,this.panelKeyboardShortcuts=null}GOLAnimator.prototype.now=function(){return Math.floor(Date.now()/this.MS_PER_SECOND)},GOLAnimator.prototype.doAnimationStep=function(){this.gol.calculateAndRenderNextState(),this.now()===this.latestStepTimestamp?this.actualFPS++:(this.$actualFPSDisplayElement.text(this.actualFPS),this.latestStepTimestamp=this.now(),this.actualFPS=0)},GOLAnimator.prototype.start=function(){if(!this.isRunning()){this.actualFPS=0,this.latestStepTimestamp=this.now();var a=this,b=this.MS_PER_SECOND/this.targetFPS;this.timerID=setInterval(function(){a.doAnimationStep()},b)}},GOLAnimator.prototype.stop=function(){this.isRunning()&&(clearInterval(this.timerID),this.timerID=null)},GOLAnimator.prototype.isRunning=function(){return null!==this.timerID},GOLAnimator.prototype.toggle=function(){this.isRunning()?this.stop():this.start()},GOLAnimator.prototype.changeTargetFramerate=function(a){var b=this.isRunning();b&&this.stop(),this.targetFPS=a,b&&this.start()},GOL.prototype.init=function(){this.gpu.init(),this.randomiseState(),this.gpu.renderState()},GOL.prototype.iterateOverAllCells=function(a){var b,c,d,e=0,f=0,g=this.STATE_HEIGHT-1;for(b=0;b<this.TOTAL_CELLS;b++)c=g*this.STATE_WIDTH+e,d=b*this.CHANNELS_PER_PIXEL,a.call(this,c,d),e++,e>=this.STATE_WIDTH&&(f++,e=0,g=this.STATE_HEIGHT-1-f)},GOL.prototype.getStateAsGOLGrid=function(){var a,b,c=this.gpu.getStatePixels(),d=GOLGridFactory.createEmpty(this.STATE_WIDTH,this.STATE_HEIGHT);return this.iterateOverAllCells(function(e,f){a=c[f+0],b=a===this.PIXEL_CHANNEL_MAX_VALUE,d.cellData[e]=b}),d},GOL.prototype.setStateUsingGOLGrid=function(a){if(a.width!==this.STATE_WIDTH)throw new Error("Grid width "+a.width+" does not match GOL state width "+this.STATE_WIDTH);if(a.height!==this.STATE_HEIGHT)throw new Error("Grid height "+a.height+" does not match GOL state height "+this.STATE_HEIGHT);var b,c,d,e=new Uint8Array(this.TOTAL_CELLS*this.CHANNELS_PER_PIXEL);this.iterateOverAllCells(function(f,g){for(b=a.cellData[f],c=b?this.COLOUR_ALIVE:this.COLOUR_DEAD,d=0;d<this.CHANNELS_PER_PIXEL;d++)e[g+d]=c[d]}),this.gpu.setStatePixels(e)},GOL.prototype.randomiseState=function(){this.setStateUsingGOLGrid(GOLGridFactory.createRandomised(this.STATE_WIDTH,this.STATE_HEIGHT))},GOL.prototype.clearState=function(){this.setStateUsingGOLGrid(GOLGridFactory.createEmpty(this.STATE_WIDTH,this.STATE_HEIGHT))},GOL.prototype.setCellState=function(a,b,c){var d=c?this.COLOUR_ALIVE:this.COLOUR_DEAD;this.gpu.setStatePixel(a,b,d)},GOL.prototype.mutateRandomCell=function(){var a=Math.floor(Math.random()*this.STATE_WIDTH),b=Math.floor(Math.random()*this.STATE_HEIGHT);this.setCellState(a,b,!0)},GOL.prototype.toggleWrapping=function(){this.enableWrapping=!this.enableWrapping},GOL.prototype.toggleMutation=function(){this.enableMutation=!this.enableMutation},GOL.prototype.calculateAndRenderNextState=function(){if(this.gpu.calculateNextState(),this.currentMode===this.MODE_RANDOM&&this.enableMutation)for(var a=0;a<this.MUTATION_RATE;a++)this.mutateRandomCell();this.gpu.renderState()},GOLGPU.prototype.init=function(){try{this.gpuPrograms={nextState:new GOLGPUProgramNextState(this,GOLShaderSources.vNextState,GOLShaderSources.fNextState),render:new GOLGPUProgramRender(this,GOLShaderSources.vRender,GOLShaderSources.fRender),blur:new GOLGPUProgramBlur(this,GOLShaderSources.vBlur,GOLShaderSources.fBlur),addAndDisplay:new GOLGPUProgramAddAndDisplay(this,GOLShaderSources.vAdd,GOLShaderSources.fAdd)}}catch(a){throw new Error("Error compiling or linking WebGLProgram: "+a.message)}this.triangleStrip={primitivesMode:this.gl.TRIANGLE_STRIP,vertexBuffer:this.igloo.array(new Float32Array([-1,-1,1,-1,-1,1,1,1])),componentsPerVertexAttribute:2,totalVertices:4},this.textures={state:this.createTexture(this.gl.NEAREST),render:this.createTexture(this.gl.NEAREST),blur:this.createTexture(this.gl.LINEAR),temp:this.createTexture(this.gl.NEAREST)},this.offscreenFramebuffer=this.igloo.framebuffer()},GOLGPU.prototype.createTexture=function(a){var b=null,c=this.gl.CLAMP_TO_EDGE,d=this.igloo.texture(b,this.gol.TEXTURE_PIXELFORMAT,c,a);switch(d.blank(this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT),this.gl.getError()){case this.gl.NO_ERROR:break;case this.gl.INVALID_VALUE:throw new Error("Failed to create texture (requested texture size "+this.gol.STATE_WIDTH+" x "+this.gol.STATE_HEIGHT+" was probably too big)");default:throw new Error("Failed to create texture (unknown error)")}return d},GOLGPU.prototype.getStatePixels=function(){var a=new Uint8Array(this.gol.TOTAL_CELLS*this.gol.CHANNELS_PER_PIXEL);return this.offscreenFramebuffer.attach(this.textures.state),this.gl.readPixels(0,0,this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT,this.gol.TEXTURE_PIXELFORMAT,this.gol.TEXTURE_PIXELTYPE,a),a},GOLGPU.prototype.setStatePixels=function(a){this.textures.state.subset(a,0,0,this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT)},GOLGPU.prototype.setStatePixel=function(a,b,c){if(0>a)throw new Error("Invalid X coord: "+a);if(0>b)throw new Error("Invalid Y coord: "+b);if(a>=this.gol.STATE_WIDTH)throw new Error("Invalid X coord: "+a+" (state width is "+this.gol.STATE_WIDTH+")");if(b>=this.gol.STATE_HEIGHT)throw new Error("Invalid Y coord: "+b+" (state height is "+this.gol.STATE_HEIGHT+")");this.textures.state.subset(c,a,b,1,1)},GOLGPU.prototype.setViewport=function(a,b){this.gl.viewport(0,0,a,b)},GOLGPU.prototype.bindDefaultFramebuffer=function(){this.igloo.defaultFramebuffer.bind()},GOLGPU.prototype.calculateNextState=function(){this.gpuPrograms.nextState.run(this.textures.state,this.textures.temp);var a=this.textures.temp;this.textures.temp=this.textures.state,this.textures.state=a},GOLGPU.prototype.renderState=function(){this.gpuPrograms.render.run(this.textures.state,this.textures.render),this.gpuPrograms.blur.run(this.textures.render,this.textures.temp,!1,this.blurBrighteningFactor),this.gpuPrograms.blur.run(this.textures.temp,this.textures.blur,!0,this.blurBrighteningFactor),this.gpuPrograms.addAndDisplay.run(this.textures.render,this.textures.blur)},GOLGPUProgram.prototype.run=function(a,b,c){if(a.length>this.gpu.MAX_TEXTURE_UNITS)throw new Error("Too many texture units requested (available: "+this.gpu.MAX_TEXTURE_UNITS+", requested: "+a.length+")");var d;for(d=0;d<a.length;d++)a[d].texture.bind(d);for(this.program.use(),this.program.attrib("aVertex",this.gpu.triangleStrip.vertexBuffer,this.gpu.triangleStrip.componentsPerVertexAttribute),d=0;d<a.length;d++)this.program.uniformi(a[d].samplerName,d);for(d=0;d<b.length;d++)this.program.uniform(b[d].name,b[d].value);for(d=0;d<c.length;d++)this.program.uniformi(c[d].name,c[d].value);this.program.draw(this.gpu.triangleStrip.primitivesMode,this.gpu.triangleStrip.totalVertices)},GOLGPUProgramAddAndDisplay.prototype.run=function(a,b){this.gpu.bindDefaultFramebuffer(),this.gpu.setViewport(this.gol.VIEW_WIDTH,this.gol.VIEW_HEIGHT);var c=[{samplerName:"uSamplerA",texture:a},{samplerName:"uSamplerB",texture:b}],d=[],e=[];GOLGPUProgram.prototype.run.call(this,c,d,e)},GOLGPUProgramBlur.prototype.run=function(a,b,c,d){var e=new Float32Array(c?[0,1]:[1,0]);this.gpu.offscreenFramebuffer.attach(b),this.gpu.setViewport(this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT);var f=[{samplerName:"uSampler",texture:a}],g=[{name:"uDimensions",value:new Float32Array([this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT])},{name:"uBlurDirection",value:e},{name:"uBrighteningFactor",value:d}],h=[];GOLGPUProgram.prototype.run.call(this,f,g,h)},GOLGPUProgramNextState.prototype.run=function(a,b){this.gpu.offscreenFramebuffer.attach(b),this.gpu.setViewport(this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT);var c=[{samplerName:"uSampler",texture:a}],d=[{name:"uStateDimensions",value:new Float32Array([this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT])}],e=[{name:"uEnableWrapping",value:this.gol.enableWrapping?1:0}];GOLGPUProgram.prototype.run.call(this,c,d,e)},GOLGPUProgramRender.prototype.run=function(a,b){this.gpu.offscreenFramebuffer.attach(b),this.gpu.setViewport(this.gol.STATE_WIDTH,this.gol.STATE_HEIGHT);var c=[{samplerName:"uSampler",texture:a}],d=[{name:"uColourTopLeft",value:this.gol.cornerColours.topLeft},{name:"uColourTopRight",value:this.gol.cornerColours.topRight},{name:"uColourBottomLeft",value:this.gol.cornerColours.bottomLeft},{name:"uColourBottomRight",value:this.gol.cornerColours.bottomRight}],e=[];GOLGPUProgram.prototype.run.call(this,c,d,e)};var GOLGridFactory={createUsingBoolArray:function(a,b,c){var d=new GOLGrid;return d.setUsingBoolArray(a,b,c),d},createUsingTextGrid:function(a,b,c){var d=new GOLGrid;return d.setUsingTextGrid(a,b,c),d},createEmpty:function(a,b){for(var c=[],d=0;a*b>d;d++)c[d]=!1;return GOLGridFactory.createUsingBoolArray(c,a,b)},createRandomised:function(a,b){for(var c=[],d=.5,e=0;a*b>e;e++)c[e]=Math.random()<d;return GOLGridFactory.createUsingBoolArray(c,a,b)}};GOLGrid.prototype.getCellIndex=function(a,b){if(0>a)throw new Error("Invalid X coord: "+a);if(0>b)throw new Error("Invalid Y coord: "+b);if(a>=this.width)throw new Error("Invalid X coord: "+a+" (width of grid is "+this.width+")");if(b>=this.height)throw new Error("Invalid Y coord: "+b+" (height of grid is "+this.height+")");return b*this.width+a},GOLGrid.prototype.getCell=function(a,b){var c=this.getCellIndex(a,b);return this.cellData[c]},GOLGrid.prototype.setCell=function(a,b,c){var d=this.getCellIndex(a,b);this.cellData[d]=c},GOLGrid.prototype.setUsingBoolArray=function(a,b,c){if(a.length!==b*c)throw new Error("Grid dimensions ("+b+" x "+c+" = "+b*c+") do not match total number of cells ("+a.length+")");this.cellData=a,this.width=b,this.height=c},GOLGrid.prototype.setUsingTextGrid=function(a,b,c){var d,e,f,g,h=a.split(/\r\n|\r|\n/g),i=[],j=h[0].length,k=h.length;for(e=0;e<h.length;e++){if(f=h[e].split(""),f.length!==j)throw new Error("Inconsistent row lengths: first row is "+j+" chars, row "+(e+1)+" is "+f.length+" chars");for(d=0;d<f.length;d++)switch(g=f[d]){case b:i.push(!0);break;case c:i.push(!1);break;default:throw new Error("Invalid character found at row "+(e+1)+" column "+(d+1)+": '"+g+"'")}}this.cellData=i,this.width=j,this.height=k},GOLGrid.prototype.paste=function(a,b,c){if(0>b)throw new Error("Invalid X coord: "+b);if(0>c)throw new Error("Invalid Y coord: "+c);if(b+a.width>this.width)throw new Error("With X coord "+b+", pasted grid will not fit within existing grid");if(c+a.height>this.height)throw new Error("With Y coord "+c+", pasted grid will not fit within existing grid");var d,e,f,g;for(e=0;e<a.height;e++)for(g=e+c,d=0;d<a.width;d++)f=d+b,this.setCell(f,g,a.getCell(d,e))},GOLGrid.prototype.getAsTextGrid=function(a,b){var c,d,e="";for(d=0;d<this.height;d++){for(c=0;c<this.width;c++)e+=this.getCell(c,d)?a:b;e+="\n"}return e},GOLUIButtonRandomModeRandomise.prototype.init=function(){var a=this;$("#buttonRandomModeRandomise").on("click",function(){a.gol.randomiseState(),a.gol.gpu.renderState()})};var GOLUIHelp={generateMarkersAndBubbles:function(){for(var a=[{id:"CellSize",html:"The width and height of each cell, in pixels<br>(changing this setting will reload the page,<br>to recreate the WebGL textures)"},{id:"TargetFramerate",html:"The number of frames-per-second to attempt to reach"},{id:"ActualFramerate",html:"The actual number of frames-per-second being displayed"},{id:"Wrapping",html:"Wrap the screen horizontally (left and right edges joined)<br>and vertically (top and bottom edges joined)"},{id:"Glow",html:"The brightness of the glow (bloom) visual effect"},{id:"RandomModeMutation",html:"Randomly add live cells<br>to prevent life from dying out"}],b=0;b<a.length;b++)!function(a){$("#tdHelpCell"+a.id).html("").append($("<i></i>").attr("class","fa fa-question-circle help-marker").on("mouseover",function(){$("#divHelpBubble"+a.id).show()}).on("mouseout",function(){$("#divHelpBubble"+a.id).hide()}),$("<div></div>").attr("id","divHelpBubble"+a.id).attr("class","help-bubble").html(a.html))}(a[b])}};GOLUIMenuApplication.prototype.init=function(){var a=this;$("#iApplicationMenuIcon").on("click",function(b){b.stopPropagation(),a.isOpen=!a.isOpen,a.update()}),$(document).on("click",function(){a.isOpen&&(a.isOpen=!1,a.update())}),$("#divApplicationMenuKeyboardShortcuts").on("click",function(){a.panelKeyboardShortcuts.open()}),$("#divApplicationMenuTroubleshooting").on("click",function(){GOLUIPanelSupport.open(!1,"Experiencing problems with WebGOL?",!0,a.gol)})},GOLUIMenuApplication.prototype.update=function(){$("#divApplicationMenuContainer").toggle(this.isOpen),$("#iApplicationMenuIcon").toggleClass("application-menu-open",this.isOpen)},GOLUIMenuCellSize.prototype.init=function(){for(var a=[],b=1;20>=b;b++)a.push(b);GOLUIUtils.populateMenuWithValues($("#selectCellSize"),a,this.gol.CELL_SIZE),$("#selectCellSize").on("change",function(){var a=parseInt($(this).val());window.location.href="index.html?cs="+a})},GOLUIPanelControl.prototype.init=function(){var a=this;$("#iCloseControlPanel").on("click",function(){a.close()})},GOLUIPanelControl.prototype.open=function(){$("#divControlPanel").fadeIn(GOLUI.FAST_FADE_DURATION),this.isOpen=!0},GOLUIPanelControl.prototype.close=function(){$("#divControlPanel").fadeOut(GOLUI.FAST_FADE_DURATION),this.isOpen=!1},GOLUIPanelKeyboardShortcuts.prototype.init=function(){var a=this;$("#iCloseKeyboardShortcutsPanel").on("click",function(){a.close()})},GOLUIPanelKeyboardShortcuts.prototype.open=function(){$("#divKeyboardShortcutsPanel").fadeIn(GOLUI.FAST_FADE_DURATION),this.isOpen=!0},GOLUIPanelKeyboardShortcuts.prototype.close=function(){$("#divKeyboardShortcutsPanel").fadeOut(GOLUI.FAST_FADE_DURATION),this.isOpen=!1};var GOLUIPanelSupport={open:function(a,b,c,d){$("#divSupportPanelTitleError").toggle(a),$("#divSupportPanelTitleTroubleshooting").toggle(!a),$("#divSupportPanelBrowserHelpContainer").toggle(c),$("#divSupportPanelMessage").text(b);var e=!1;if(null!==d)try{var f=GOLUtils.getWebglInfo(d),g=GOLUtils.getWebglWarnings(d),h=GOLUIUtils.createListElements(f),i=GOLUIUtils.createListElements(g);$("#ulSupportPanelWebGLInfo").html("").append(h),$("#ulSupportPanelWebGLWarnings").html("").append(i),$("#divSupportPanelWebGLWarningsContainer").toggle(g.length>0),e=!0}catch(j){}$("#divSupportPanelWebGLContainer").toggle(e),$("#divSupportPanel").fadeIn(GOLUI.FAST_FADE_DURATION)},initCloseButton:function(){$("#iCloseSupportPanel").show(),$("#iCloseSupportPanel").on("click",function(){GOLUIPanelSupport.close()})},canBeClosed:function(){return $("#divSupportPanel").is(":visible")&&$("#iCloseSupportPanel").is(":visible")},close:function(){$("#divSupportPanel").fadeOut(GOLUI.FAST_FADE_DURATION)}};GOLUIShortcutKeys.prototype.init=function(){var a=this;$(document).on("keyup",function(b){switch(b.which){case 80:a.golAnimator.toggle(),a.toolbar.update();break;case 83:a.golAnimator.isRunning()||a.golAnimator.doAnimationStep();break;case 27:GOLUIPanelSupport.canBeClosed()?GOLUIPanelSupport.close():a.panelKeyboardShortcuts.isOpen?a.panelKeyboardShortcuts.close():a.panelControl.isOpen&&a.panelControl.close()}})},GOLUISliderGlow.prototype.init=function(){$("#sliderGlow").val(10*this.gpu.blurBrighteningFactor),$("#divGlow").text(10*this.gpu.blurBrighteningFactor);var a=this;$("#sliderGlow").on("input",function(){var b=parseInt($(this).val());a.gpu.blurBrighteningFactor=b/10,$("#divGlow").text(b)})},GOLUISliderTargetFramerate.prototype.init=function(){$("#sliderTargetFramerate").val(this.golAnimator.targetFPS),$("#divTargetFramerate").text(this.golAnimator.targetFPS);var a=this;$("#sliderTargetFramerate").on("input",function(){var b=parseInt($(this).val());a.golAnimator.changeTargetFramerate(b),$("#divTargetFramerate").text(b)})},GOLUISwitcheryMutation.prototype.init=function(){this.switchery=GOLUIUtils.createSwitchery("checkboxSwitcheryRandomModeMutation");var a=this;$("#checkboxSwitcheryRandomModeMutation").on("change",function(){a.gol.toggleMutation(),GOLUIUtils.updateSwitcheryState(a.switchery,a.gol.enableMutation)}),GOLUIUtils.updateSwitcheryState(this.switchery,this.gol.enableMutation)},GOLUISwitcheryWrapping.prototype.init=function(){this.switchery=GOLUIUtils.createSwitchery("checkboxSwitcheryWrapping");var a=this;$("#checkboxSwitcheryWrapping").on("change",function(){a.gol.toggleWrapping(),GOLUIUtils.updateSwitcheryState(a.switchery,a.gol.enableWrapping)}),GOLUIUtils.updateSwitcheryState(this.switchery,this.gol.enableWrapping)},GOLUIToolbar.prototype.init=function(){this.initCanvas(),this.initPlayPause(),this.initStepForwards(),this.initOpenControlPanel();var a=this;$("#divToolbar").on("mousemove",function(){a.clearFadeoutTimeout()}),this.fadeIn(GOLUI.SLOW_FADE_DURATION)},GOLUIToolbar.prototype.initCanvas=function(){var a=this;$("#golCanvas").on("mousemove",function(){a.isDisplayed||a.fadeIn(GOLUI.FAST_FADE_DURATION),a.clearFadeoutTimeout(),a.hasControlPanelEverBeenOpened&&(a.fadeoutTimeoutID=setTimeout(function(){a.fadeOut(GOLUI.SLOW_FADE_DURATION),a.fadeoutTimeoutID=null},1500))})},GOLUIToolbar.prototype.initPlayPause=function(){var a=this;$("#iToolbarPlay, #iToolbarPause").on("click",function(){a.golAnimator.toggle(),a.update()})},GOLUIToolbar.prototype.initStepForwards=function(){var a=this;$("#iToolbarStepForwards").on("click",function(){a.golAnimator.isRunning()||a.golAnimator.doAnimationStep()})},GOLUIToolbar.prototype.initOpenControlPanel=function(){var a=this;$("#iToolbarOpenControlPanel").on("click",function(){a.fadeOut(GOLUI.FAST_FADE_DURATION),a.panelControl.open(),a.hasControlPanelEverBeenOpened=!0})},GOLUIToolbar.prototype.fadeIn=function(a){$("#divToolbar").fadeIn(a),this.isDisplayed=!0},GOLUIToolbar.prototype.fadeOut=function(a){$("#divToolbar").fadeOut(a),this.isDisplayed=!1},GOLUIToolbar.prototype.clearFadeoutTimeout=function(){null!==this.fadeoutTimeoutID&&(clearTimeout(this.fadeoutTimeoutID),this.fadeoutTimeoutID=null)},GOLUIToolbar.prototype.update=function(){var a=this.golAnimator.isRunning();$("#iToolbarPlay").toggle(!a),$("#iToolbarPause").toggle(a),$("#iToolbarStepForwards").toggleClass("tool-disabled",a)},GOLUI.FAST_FADE_DURATION=200,GOLUI.SLOW_FADE_DURATION=1e3,GOLUI.prototype.init=function(){GOLUIPanelSupport.initCloseButton(),this.panelControl=new GOLUIPanelControl,this.panelControl.init(),this.panelKeyboardShortcuts=new GOLUIPanelKeyboardShortcuts,this.panelKeyboardShortcuts.init();var a=new GOLUIMenuApplication(this.gol,this.panelKeyboardShortcuts),b=new GOLUIMenuCellSize(this.gol);a.init(),b.init();var c=new GOLUISliderTargetFramerate(this.golAnimator),d=new GOLUISliderGlow(this.gol.gpu);c.init(),d.init();var e=new GOLUISwitcheryWrapping(this.gol),f=new GOLUISwitcheryMutation(this.gol);e.init(),f.init(),this.toolbar=new GOLUIToolbar(this.golAnimator,this.panelControl),this.toolbar.init();var g=new GOLUIButtonRandomModeRandomise(this.gol),h=new GOLUIShortcutKeys(this.golAnimator,this.toolbar,this.panelKeyboardShortcuts,this.panelControl);g.init(),h.init(),GOLUIHelp.generateMarkersAndBubbles()};var GOLUIUtils={createListElements:function(a){for(var b=[],c=0;c<a.length;c++)b.push($("<li></li>").text(a[c]));return b},createMenuOption:function(a){return $("<option></option>").attr("value",a.value).text(a.label)},populateMenu:function(a,b,c){var d,e,f;for(d=0;d<b.length;d++)e=b[d],f=GOLUIUtils.createMenuOption(e),e.value===c&&f.prop("defaultSelected",!0),a.append(f)},populateMenuWithValues:function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push({value:b[e],label:b[e]});GOLUIUtils.populateMenu(a,d,c)},createSwitchery:function(a){var b=document.getElementById(a),c={color:"#00c000",secondaryColor:"#c00000"};return new Switchery(b,c)},updateSwitcheryState:function(a,b){a.isChecked()!==b&&a.setPosition(!0)}},GOLUtils={getWebglInfo:function(a){var b=a.gl,c=["Vendor = "+b.getParameter(b.VENDOR),"Renderer = "+b.getParameter(b.RENDERER),"Version = "+b.getParameter(b.VERSION),"Shading language version = "+b.getParameter(b.SHADING_LANGUAGE_VERSION)];return b.getError(),c},getWebglWarnings:function(a){var b=a.gl,c=[];!(a.igloo.canvas.getContext("webgl")instanceof WebGLRenderingContext)&&a.igloo.canvas.getContext("experimental-webgl")instanceof WebGLRenderingContext&&c.push("Browser indicates WebGL support is experimental; not all WebGL functionality may be supported, and content may not run as expected"),(b.getParameter(b.RED_BITS)!==a.BITS_PER_PIXEL_CHANNEL||b.getParameter(b.GREEN_BITS)!==a.BITS_PER_PIXEL_CHANNEL||b.getParameter(b.BLUE_BITS)!==a.BITS_PER_PIXEL_CHANNEL||b.getParameter(b.ALPHA_BITS)!==a.BITS_PER_PIXEL_CHANNEL)&&c.push("The number of bits per pixel channel should be "+a.BITS_PER_PIXEL_CHANNEL+", but are actually: red = "+b.getParameter(b.RED_BITS)+", green = "+b.getParameter(b.GREEN_BITS)+", blue = "+b.getParameter(b.BLUE_BITS)+", alpha = "+b.getParameter(b.ALPHA_BITS));var d=b.getParameter(b.MAX_TEXTURE_SIZE);(a.STATE_WIDTH>d||a.STATE_HEIGHT>d)&&c.push("Required texture size is "+a.STATE_WIDTH+" x "+a.STATE_HEIGHT+" but max supported texture size is "+d+" x "+d);var e=b.getParameter(b.MAX_VIEWPORT_DIMS),f=b.getParameter(b.VIEWPORT);return(a.VIEW_WIDTH>e[0]||a.VIEW_HEIGHT>e[1])&&c.push("Required viewport size for canvas is "+a.VIEW_WIDTH+" x "+a.VIEW_HEIGHT+" but max supported viewport size is "+e[0]+" x "+e[1]+" and current viewport size is "+f[2]+" x "+f[3]),b.getError(),c}};